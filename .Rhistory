if (!require("BioManager",quietly = True))
install.packages("BiocManager")
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("TCGAbiolinks")
library(TCGAbiolinks)
query_brca <- GDCquery()
query_brca <- GDCquery(project = "TCGA-BRCA",data.category = "Transcriptome Profiling",data.type ="Gene Expression Qualification",workflow.type = "STAR - Counts")
query_brca <- GDCquery(project = "TCGA-BRCA",data.category = "Transcriptome Profiling",data.type ="Gene Expression Quantification",workflow.type = "STAR - Counts")
brca_data <- GDCprepare(query=query_brca)
GDCdownload(query = query_brca)
# SET WORKING DIRECTORY
getwd()
getwd()
getwd()
library(tidyr)
library(ggplot2)
library(RColorBrewer)
df <- read.csv('pokemon.csv')
df <- read.csv('D:/MSc/194bcff35001e7eb53a2a8b441e8b2c6-92200bc0a673d5ce2110aaad4544ed6c4010f687/pokemon.csv')
df
View(df)
paste('The number of columns: ',ncol(df))
print(paste('The number of columns: ',ncol(df)))
paste('The number of columns:',ncol(df))
paste('The number of rows:',nrow(df))
paste('The dimension:',dim(df))
paste('Collumn names:',colnames(df))
class(colnames(df))
print('Colum names:')
colnames(df)
head(x = df,n = 2)
head(x = df,n = 4)
tail(x = df,n = 4) # DISPLAY LAST 4 COLUMNS
head(x = df,n = 10) # DISPLAY FIRST 10 COLUMNS
is.na(df)
sum(is.na(df))
all(is.na(df))
is.na.data.frame(df)
sum(c(TRUE,FALSE,TRUE))
paste('The number of null values:',sum(is.null(df)))
df == ''
paste('The number of blank values:', sum(df==''))
for (col in colnames(df)) {
paste('The number of blank values in',col,':',df$col=='')
}
for (col in colnames(df))
{
paste('The number of blank values in',col,':',df$col=='')
}
for (col in list(colnames(df)))
{
paste('The number of blank values in',col,':',df$col=='')
}
for (col in list(colnames(df)))
{
print(col)
}
for (col in colnames(df))
{
paste('The number of blank values',col,sum(df[col]==''))
}
for (col in colnames(df))
{
paste('The number of blank values',sum(df[col]==''))
}
colnames(df)
round(sum(df$Type.2 == '')/nrow(df),4)*100
paste('The percentage of Type.2:',round(sum(df$Type.2 == '')/nrow(df),4)*100,'%')
colnames(df)
paste('The percentage of blank values in Type.2:',round(sum(df$Type.2 == '')/nrow(df),4)*100,'%') # CHECK THE PROPORTION OF TYPE.2
class(colnames(df))
c(colnames(df))
class(c(colnames(df)))
subset(df,drop = 4)
subset(df,select= -Type.1)
subset(df,select= -Type.2)
df <- subset(df,select= -Type.2)
paste('The number of blank values:', sum(df==''))
class(df$Legendary)
class(df$Legendary)
paste('Data type of legendary',class(df$Legendary))
paste('Data type of legendary:',class(df$Legendary))
class(factor(df$Legendary))
df$Legendary <- factor(df$Legendary)
paste('Mean of "Attack":',mean(df$Attack))
paste("Mean of 'Attack':",mean(df$Attack))
paste("STDEV of 'Attack:'",stderr(df$Attack))
paste("Min value of 'Attack'",min(df$Attack))
paste("Max value of 'Attack'",max(df$Attack))
paste("Median of 'Attack':",median(df$Attack))
paste("Mode of 'Attack':",mode(df$Attack))
paste("Mode of 'Attack':", quantile(df$Attack))
hist(df$Attack)
hist(df$Attack,
xlab = '',
main = 'HISTOGRAM OF ATTACK')
hist(df$Attack,
xlab = '',
main = 'HISTOGRAM OF ATTACK',
breaks = 20)
hist(df$Attack,
xlab = '',
main = 'HISTOGRAM OF ATTACK',
breaks = 20,
col = 'tomato',
border = 'grey')
unique(df$Type.1)
for (i in unique(df$Type.1))
{
print(i)
}
for (i in unique(df$Type.1))
{
print(df[df$Type.1==i,'Attack'])
}
for (i in unique(df$Type.1))
{
print(mean(df[df$Type.1==i,'Attack']))
}
for (i in unique(df$Type.1))
{
paste('Mean value of',i,':',mean(df[df$Type.1==i,'Attack']))
}
for (i in unique(df$Type.1))
{
paste('Mean value of',mean(df[df$Type.1==i,'Attack']))
}
for (i in unique(df$Type.1))
{
mean(df[df$Type.1==i,'Attack'])
}
for (i in unique(df$Type.1))
{
print(mean(df[df$Type.1==i,'Attack']))
}
unique(df$Legendary)
total_legendary <- mean(df[df$Legendary =='True','Total'])
total_non_legendary <- mean(df[df$Legendary=='False','Total'])
paste('Total of legend pokemons is higher than that of non-legend counterparts',total_legendary - total_non_legendary)
paste('Total of legend pokemons is higher than that of non-legend counterparts:',total_legendary - total_non_legendary)
paste('Total of legend pokemons is higher than that of non-legend counterparts:',
round(total_legendary - total_non_legendary,4))
speed_electric <- mean(df[df$Type.1=='Electric','Speed'])
speed_flying <- mean(df[df$Type.1=='Flying','Speed'])
difference_speed <- speed_electric - speed_flying
if (difference_speed > 0){
print('Electric pokemons are faster than flying counterparts')
} else if (difference_speed < 0){
print('Electric pokemons are slower than flying counterparts')
} else {
print('The speed of electric pokemons are similar to that of flying counterparts')
}
hist(df$Total)
hist(df$Total,
breaks = 20,
col = '#DC143C',
xlab ='',
main = 'HISTOGRAM OF TOTAL')
hist(df$Total,
breaks = 40,
col = '#DC143C',
xlab ='',
main = 'HISTOGRAM OF TOTAL')
hist(df$Total,
breaks = 40,
col = '#DC143C',
xlab ='',
main = 'HISTOGRAM OF TOTAL',include.lowest = TRUE)
hist(df$Total,
breaks = 40,
col = '#DC143C',
xlab ='',
main = 'HISTOGRAM OF TOTAL',include.lowest = FALSE)
hist(df$Total,
breaks = 40,
col = '#DC143C',
xlab ='',
main = 'HISTOGRAM OF TOTAL',axes = FALSE)
hist(df$Total,
breaks = 40,
col = '#DC143C',
xlab ='',
main = 'HISTOGRAM OF TOTAL')
boxplot(formula = Attack ~ Type.1,data = df)
boxplot(formula = Attack ~ Type.1,
data = df,
main = 'BOXPLOT OF ATTACK GROUPED BY TYPE 1')
barplot(height = df$Type.1)
barplot(formula = Type.1 ~ Type.1,data=df)
barplot(height = df$Type.1)
heatmap(df[c('HP','Attack','Defense','Sp.Atk','Sp.Def','Speed')])
heatmap(df[c('HP','Attack','Defense','Sp.Atk','Sp.Def','Speed'),])
heatmap(
subset(x = df,
select = c('HP','Attack','Defense','Sp.Atk','Sp.Def','Speed')
)
)
subset(x = df,
select = c('HP','Attack','Defense','Sp.Atk','Sp.Def','Speed')
)
subset(x = df,
select = c('HP','Attack','Defense','Sp.Atk','Sp.Def','Speed')
)
heatmap(
subset(x = df,select = c('HP','Attack','Defense','Sp.Atk','Sp.Def','Speed')
)
)
df <- read.csv('D:/MSc/194bcff35001e7eb53a2a8b441e8b2c6-92200bc0a673d5ce2110aaad4544ed6c4010f687/pokemon.csv')
View(df)
df <- read.csv('D:/MSc/194bcff35001e7eb53a2a8b441e8b2c6-92200bc0a673d5ce2110aaad4544ed6c4010f687/pokemon.csv',
row.names = 1 )
df <- read.csv('D:/MSc/194bcff35001e7eb53a2a8b441e8b2c6-92200bc0a673d5ce2110aaad4544ed6c4010f687/pokemon.csv',
row.names = 'X')
df <- read.csv('D:/MSc/194bcff35001e7eb53a2a8b441e8b2c6-92200bc0a673d5ce2110aaad4544ed6c4010f687/pokemon.csv',
row.names = 'X.')
colnames(df)
df$X. <- NULL
paste('The number of columns:',ncol(df))
paste('The number of rows:',nrow(df))
paste('The dimension:',dim(df))
cat('Column names: \n',paste(colnames(df),collapse = '\n -'))
cat('Column names: \n -',paste(colnames(df),collapse = '\n -'))
cat('Column names: \n-',paste(colnames(df),collapse = '\n -'))
cat('Column names: \n -',paste(colnames(df),collapse = '\n - '))
cat('Column names: \n -',paste(colnames(df),collapse = '\n - '),'ec \n','ut \n')
str(df)
paste('The number of null values:',sum(is.null(df))) # CHECK MISSING VALUES
paste('The number of blank values:', sum(df=='')) # CHECK BLANK VA
colnames(df)
paste('The percentage of blank values in Type.2:',round(sum(df$Type.2 == '')/nrow(df),4)*100,'%')
df <- subset(df,select= -Type.2) # DROP TYPE 2 COLUMN
paste('The number of blank values:', sum(df=='')) # RE-CHECK BLANK VALUES
paste('Data type of legendary:',class(df$Legendary)) # CHECK DATA TYPE OF LEGENDARY COLUMN
df$Legendary <- factor(df$Legendary) # CONVERT 'LEGENDARY' INTO FACTOR
df$Legendary
paste("Mean of 'Attack':",mean(df$Attack))
paste("STDEV of 'Attack:'",sd(df$Attack))
paste("Min value of 'Attack':",min(df$Attack))
paste("Max value of 'Attack':",max(df$Attack))
paste("Median of 'Attack':",median(df$Attack))
paste("Mode of 'Attack':", quantile(df$Attack))
paste("Mean of 'Attack':",mean(df$Attack),'\n')
paste("STDEV of 'Attack:'",sd(df$Attack),'\n')
paste("Min value of 'Attack':",min(df$Attack),'\n')
paste("Max value of 'Attack':",max(df$Attack),'\n')
paste("Median of 'Attack':",median(df$Attack),'\n')
paste("Mode of 'Attack':", quantile(df$Attack),'\n')
cat('-Quantiles: \n -',paste(quantile(df$Attack),collapse = '\n - '))
cat('Quantiles: \n -',paste(quantile(df$Attack),collapse = '\n - ')
cat('Quantiles: \n -',paste(quantile(df$Attack),collapse = '\n - '))
cat('Quantiles: \n -',paste(quantile(df$Attack),collapse = '\n - '))
get_mode <- function(x){
unique_value <-unique(x)
x[which.max(tabulate(match(x,unique_value)))]
}
get_mode(df$Attack)
summary(df)
df_result<-read.csv('D:/MSc/demo_TCGA_BRCA/results/DGE_analysis.csv',row.names = 1)
View(df_result)
is.null(df_result)
is.na(df_result)
all(is.na(df_result))
rowsum(is.na(df_result))
selected_df <- df_result[(df_result$padj <0.05)&(abs(df_result$log2FoldChange)>1),]
View(selected_df)
df_result[is.null(selected_df$log2FoldChange)&is.null(selected_df$log2FoldChange),]
drop_na(df_result)
drop_na(selected_df)
drop_na_(selected_df)
any(is.null(selected_df))
is.null(selected_df)
is.na(selected_df)
selected_df[is.na(selected_df)]
selected_df[is.na(selected_df),]
selected_df[~is.na(selected_df),]
selected_df[!is.na(selected_df),]
selected_df <- selected_df[!is.na(selected_df),]
old.pal <-palette(c('#FAAC68','#6DC3BB')) # SET A PALATTE
mar <- par(mar=c(4,4,2,1),cex.main=1.5) # SET A MARGIN
#title <- paste(groups[1],'vs',groups[2]) # SET A TITLE OF THE PLOT
plot(res$log2FoldChange,
-log10(res$padj),
main='UPREGULATION VS DOWNREGULATION',
xlab='log2FoldChange',
ylab='-log(Padj)',
pch=20,
cex=0.5)
plot(selected_df$log2FoldChange,-log10(selected_df$padj))
df_result<-read.csv('D:/MSc/demo_TCGA_BRCA/results/DGE_analysis.csv',row.names = 1)
df_result <- df_result[!is.na(df_result),]
plot(df_resultdf$log2FoldChange,-log10(df_result$padj))
plot(df_result$log2FoldChange,-log10(df_result$padj))
plot(df_result$log2FoldChange,
-log10(df_result$padj),
xlab = 'log2FoldChange',
ylab = '-log(padj)')
plot(df_result$log2FoldChange,
-log10(df_result$padj),
xlab = 'log2FoldChange',
ylab = '-log(padj)',
cex=0.5)
plot(df_result$log2FoldChange,
-log10(df_result$padj),
xlab = 'log2FoldChange',
ylab = '-log(padj)',
cex=0.5,
pch=20)
old.pal <-palette(c('#FAAC68','#6DC3BB')) # SET A PALATTE
mar <- par(mar=c(4,4,2,1),cex.main=1.5) # SET A MARGIN
plot(df_result$log2FoldChange,
-log10(df_result$padj),
xlab = 'log2FoldChange',
ylab = '-log(padj)',
main = 'UPREGULATED GENES VS DOWNREGULATED GENES',
cex=0.5,
pch=20)
with(subset(df_result,abs(log2FoldChange)>=0.5 & padj<0.05),
points(log2FoldChange,
-log10(padj),
pch=20,
col=(sign(log2FoldChange)+3)/2,
cex=1))
legend('bottomleft',
legend = c('up','down'),
title = paste('Padj<',0.05,sep = ''),
pch=20,
col = 1:2)
old.pal <-palette(c('#FAAC68','#6DC3BB')) # SET A PALATTE
mar <- par(mar=c(4,4,2,1),cex.main=1.5) # SET A MARGIN
plot(df_result$log2FoldChange,
-log10(df_result$padj),
xlab = 'log2FoldChange',
ylab = '-log(padj)',
main = 'UPREGULATED GENES VS DOWNREGULATED GENES',
cex=0.5,
pch=20)
with(subset(df_result,abs(log2FoldChange)>=0.5 & padj<0.05),
points(log2FoldChange,
-log10(padj),
pch=20,
col=(sign(log2FoldChange)+3)/2,
cex=0.75))
legend('bottomleft',
legend = c('up','down'),
title = paste('Padj<',0.05,sep = ''),
pch=20,
col = 1:2)
setwd('D:/MSc/demo_TCGA_BRCA')
df<-read.csv('D:\MSc\demo_TCGA_BRCA\Final data\meta_data.csv')
df<-readRDS('D:\MSc\demo_TCGA_BRCA\Final data\meta_data.rds')
df<-readRDS('D:/MSc/demo_TCGA_BRCA/Final data/meta_data.rds')
View(df)
df$follow_ups_disease_response
df<-df$follow_ups_disease_response
df<-readRDS('D:/MSc/demo_TCGA_BRCA/Final data/meta_data.rds')
df<-subset(df,c('follow_ups_disease_response'))
df[,'follow_ups_disease_response']
df[[,'follow_ups_disease_response']]
df[,'follow_ups_disease_response',drop=FALSE]
df<-df[,'follow_ups_disease_response',drop=FALSE]
write.csv('D:/MSc/demo_TCGA_BRCA/Final data/temp_meta_data.csv')
write.csv(df,'D:/MSc/demo_TCGA_BRCA/Final data/temp_meta_data.csv')
